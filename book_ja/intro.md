---
title: Browsers and the Web
type: Introduction
next: history
prev: preface
...

私（クリス）は大人になってからずっとwebについて詳しい。私にとってwebとは技術的な仲間のようなもので、勉強でも仕事でもwebから離れたことはない。おそらく、それはあなたも同じであろう。そして、webを使うということは、ブラウザを使うということでもある。私は、あなたがこの本を読むことで、私のようにwebブラウザに恋に落ちることを願っている。

ブラウザと私
==================

1990年代初頭に、私が初めてwebとその前身に出会って以来、私はブラウザとネットワーク化されたユーザーインターフェースの概念に魅了されてきた。初期のwebの形であったとしても、webサーフィンをしているとき、私はコンピューティングの未来を見ているように感じた。ある意味で、webと私はともに成長してきた。例えば1994年、webが商業化した年と同じ年に、私の大学生活は始まった。そこで私はかなりの時間をwebサーフィンに費やし、1999年に大学を卒業する頃には、ブラウザは有名な dot-com 投機のゴールドラッシュを煽っていた。それだけでなく、私が今働いている Google もwebの子供であり、その時期に設立された。

大学1年生のとき、私はRedHatのセールスマンのプレゼンテーションに参加した。プレゼンはRedHat Linuxを売り込むのが狙いで、おそらくそれを「未来のオペレーティングシステム」と呼び、「Linuxデスクトップの年」について推測していた。しかし、RedHatが直面する困難について質問されたとき、セールスマンはLinuxではなくwebについて言及した。彼は、「誰かが、Linux用の良いブラウザを作る必要がある」と言った。当時でさえ、web創成期にはすでにブラウザはすべてのコンピュータに必要なコンポーネントだった。彼は、「より良いブラウザを作るのはどれだけ難しいか？」という挑戦さえ投げかけた。確かに、どれほど難しいことだろうか？何がそんなに難しいのか？その疑問は、長い間私の心に引っかかっていた。

実に難しい！Chromeの開発に11年関わってきて今、彼の問いに対する答えがわかった。
ブラウザの構築は簡単でありながら信じられないほど難しく、意図的でもあり偶発的でもある。そして、どこを見ても、webの進化と歴史がひとつのコードベースに集約されている。それは楽しく、果てしなく興味深い。

こうして私はwebブラウザに恋に落ちた。なぜあなたもそうなるのか、今からその理由伝えよう

歴史の中のweb
==================

webは壮大でクレイジーな実験だ。今や、webでビデオを見たり、ニュースを読んだり、友人とつながったりするのは当たり前のことだ。そのため、webは単純明快で、完成され、すでに構築されているように思われがちだ。しかし、webは単純でも明白でもない（そして確かに完成していない）。これは、コンピューティングのほぼ初期にまでさかのぼる、人々が互いにつながり、学び合うことを支援する方法についての、実験と研究の結果である。

初期のインターネットは、主に大学や研究所、大企業のコンピュータが物理的なケーブルで結ばれ、アプリケーション固有のプロトコルで通信する世界規模のコンピューターのネットワークだった。初期のwebは、ほとんどがこの基盤の上に構築されていた。webページは、特定のコンピューターに保存された特定のフォーマットのファイルだった。webページのアドレスにはコンピュータとファイルの名前が付けられており、初期のサーバーはディスクからファイルを読み取る以外にほとんど何もしなかった。webの論理的構造は、その物理的構造を反映していた。

多くのことが変わった。現在のwebページのHTMLは通常、動的に組み立てられ、あなたのブラウザにオンデマンドで送信される。組み上げられるコンテンツは、ニュース、受信トレイのコンテンツ、あなたの好みに合わせてダイナミックに変化する広告などがある。アドレスでさえ、もはや特定のコンピュータを識別することはできない。コンテンツ配信ネットワークは、世界中の何千台ものコンピューターのいずれかにリクエストを送る。より高いレベルでは、ほとんどのwebページは誰かの自宅のコンピューターからではなく、大企業のソーシャルメディアプラットフォームかクラウドコンピューティングサービスから提供されている。

すべてが変化しても、webの本質である核となる構成要素は変わらないものもある：

* webは、ハイパーリンクで結ばれた情報のネットワークである
* ユーザーは、ブラウザと呼ばれるユーザーエージェントを使用してwebを使う
* 情報はHTTPで要求され、HTML文書フォーマットで構造化される
* ドキュメントは、コンテンツではなくURLによって識別され、動的に生成されることもある
* webページは、画像、動画、CSS、JavaScriptなど、さまざまな形式の補助アセットにリンクすることができる
* これらの構成要素はすべてオープンで標準化されており、自由に使用または再利用することができる

哲学的な問題として、おそらくこれらの原則のどちらか一方は二の次なのだろう。webのネットワーキングとレンダリングの側面を区別しようとすることもできる。リンクやネットワーキングを、特定のプロトコルやデータフォーマットの選択から抽象化することもできる。ブラウザが理論的に必要かどうかを問うこともできるし、HTTP、URL、ハイパーリンクだけがwebに本当に必要な部分だと主張することもできる。

結局のところ、webは実験であり、コア技術は進化し、成長していく。しかし、webは偶然の産物ではない。そのデザインは、コンピューティングだけでなく、人間がどのようにつながり、相互作用できるのかという真実を反映している。ホスティングとコンテンツの仮想化が進む中、webが生き残っただけでなく繁栄したのは、特にこのオリジナルなデザインの優雅さと効果によるものだ。

理解すべき重要なことは、この壮大な実験は終わっていないということだ。webの本質は残るが、webブラウザを作ることによって、その未来を形作るチャンスがあるのだ。

実際のブラウザコードベース
======================

ブラウザに貢献するとはどんなことかを話そう。Chromeの開発を始めて数ヶ月のあるとき、<br>タグを実装しているコードにであった—あの懐かしい<br>タグ、webページに改行を挿入するために何度も使ってきた！ そして、Chromeでも、この本に登場するシンプルなブラウザでも、その実装は実際にはほとんどコードがないことが判明した。

しかし、Chrome全体としては、その機能、スピード、セキュリティ、信頼性には驚かされる。Chromeの開発には、何千人もの人年が費やされた。web上の何千もの企業、何百万人もの開発者、そして何十億人ものwebユーザーのために、より多くの機能を追加し、パフォーマンスを向上させ、「webエコシステム」に対応し続けなければならないというプレッシャーが常にある。

このようなコードベースに取り組むと、圧倒されるように感じることがある。会ったこともない誰かが15年前に最後に触ったコードの行を見つけたり、今でも存在すら知らなかったファイルやクラスを発見したり、必要なさそうなのに重要だと判明したコードの行を見たりすることがよくある。その15年前のコードは何をしているのだろう？初めて見るファイルの目的は何だろう？そのコードには理由があるのだろうか？

どのブラウザにも、小さなミスから無数のミックスアップやミスマッチまで、何千もの未修正のバグがある。どのブラウザも、最後のパフォーマンスを絞り出すために、延々とチューニングと最適化を続けなければならない。どのブラウザも、コードの複雑さを軽減するために、しばしばモジュール化と抽象化を慎重に導入しながら、継続的にコードをリファクタリングする骨の折れる作業を必要とする。

ブラウザが多くの巨大なコードベースと異なるのは、その緊急性だ。ブラウザは「レガシー」コードベースと同じくらい古いものだが、レガシーではないし、放棄されたものでも、半ば非推奨のものでも、置き換えが予定されているものでもない。それどころか、世界経済にとって不可欠なものなのだ。そのため、ブラウザエンジニアは、放棄したり置き換えたりするのではなく、修正・改善しなければならない。また、webの特性そのものが高度に分散化されているため、ブラウザが満たすユースケースは、特定のブラウザを「所有」または「管理」する企業によって決まるわけではない。あなたを含む他の人々が、アイデア、提案、実装に貢献することができるし、実際に貢献している。

驚くべきは、その規模とペースと複雑さにもかかわらず、貢献する余地がまだたくさんあるということだ。今日のすべてのブラウザはオープンソースであり、web開発者のコミュニティ全体にその実装を開放している。ブラウザは巨大な研究プロジェクトのように進化し、常に新しいアイデアが提案され、テストされている。予想通り、失敗する機能もあれば成功する機能もある。成功したものは仕様になり、他のブラウザによって実装される。どのwebブラウザも、バグの修正、新機能の提案、有望な最適化の実装など、貢献に対してオープンである。

ブラウザコードの概念
=====================

HTMLとCSSはブラックボックスである。達成すべき結果を指定し、どのように実現するかはブラウザ自身が責任を持つ、宣言的なAPIである。web開発者は、自分たちでwebページのピクセルを描くことはないし、たいていの場合、それを行うこともできない。

正しく処理をするかどうかによって、ブラウザを魔法のようにしたり、イライラさせるものにしたりする。しかし、ブラウザはまた、ユニークな挑戦、興味深いアルゴリズム、巧妙な最適化などを持ち合わせた、かなり珍しいソフトウェアでもある。ブラウザは純粋に楽しむために研究する価値がある。

これらを全て機能させているのは、webブラウザが、制御の反転、制約プログラミング、宣言的プログラミング、を実装しているからである。webは制御を逆転させ、ブラウザという仲介者を介してレンダリングの大部分を処理し、web開発者はこの仲介者にレンダリングパラメータとコンテンツを指定する。さらに、これらのパラメータは通常、値を直接指定するのではなく、画面上の要素の相対的なサイズと位置間の制約の上で指定される。ブラウザはその制約を解決して、これらの値を見つけ出す。同じ考え方がアクションにも当てはまり、webページは、アクションがいつ行われるかを指定することなく実行されることを要求することがほとんどである。この宣言的なスタイルは、開発者の視点からは変更が「すぐに適用される」ことを意味するが、その裏では、ブラウザは怠慢になり、変更が外部に見えるようになるまで適用を遅らせることができる。これは、後続のAPI呼び出しのため、あるいはページをユーザーに表示していなければならないためである。

ブラウザの設計が特殊であることには、現実的な理由がある。たしかに、開発者はいくつかのコントロールとエージェンシーを失う。ピクセルが間違っていても、開発者はそれを直接修正できない。しかし、細かいことを気にすることなくコンテンツをweb上に展開し、現存するほとんどすべてのコンピューティングデバイスでそのコンテンツを即座に利用可能にし、将来にわたってアクセス可能な状態を維持する能力を得ることができ、ソフトウェアの避けがたい陳腐化をほとんど回避することができる。

私にとってブラウザとは、アルゴリズムに命が吹き込まれる場所だ。ブラウザには、どんなコンピューターゲームよりも複雑で強力なレンダリングエンジン、フルネットワーキングスタック、巧妙なデータ構造と並列プログラミング技術、仮想マシン、インタプリタ言語、ジャストインタイムコンパイラー、ワールドクラスのセキュリティサンドボックス、そしてユニークでダイナミックなデータ保存システムが搭載されている。

実際、あなたはいつもブラウザを使っている。もしかしたら、この本を読むために使っているかもしれない！webにはすでに慣れ親しんでいるから、ブラウザのアルゴリズムは、他のどこよりも親しみやすくなっている

ブラウザの役割
=======================

webは現代のコンピューティングの中心にある。年々、私たちがコンピュータを使って行うことに対して、webが及ぶ範囲が拡大している。現在では、文書ベースの情報共有という当初の用途をはるかに超えている。多くの人が、他のアプリケーションを1つも使わず、1日中ブラウザで過ごしている！さらに、現在ではデスクトップアプリケーションはしばしば、webアプリケーションとして構築され、提供される。webページはブラウザによって読み込まれるが、インストールされたアプリケーションのように使用される。モバイルデバイスでも、UIの一部をレンダリングするために、アプリにはしばしばブラウザが組み込まれる。
おそらく将来的には、デスクトップとモバイルデバイスの両方が、webアプリケーションのコンテナとして機能するようになるだろう。すでに、ブラウザはコンピューティングに不可欠な重要な要素となっている。

webのこの中心的な位置付けを考えると、webがどのように機能するかを知ることは価値がある。特に、ユーザーエージェントであり、最終的にはwebの原則を実現するwebのインタラクションの仲介者であるブラウザに注目することは価値がある。ブラウザはwebの実装者でもある。そのサンドボックスはwebブラウジングを安全に保ち、そのアルゴリズムは宣言的文書モデルを実装し、そのUIはリンクをナビゲートする。ブラウザが超効率的であれば、webページは高速にロードされ、スムーズに反応する。

ブラウザとあなた
================

本書はシンプルなブラウザを作る方法を説明しており、それはシンプルであるにもかかわらず、興味深いwebページを表示し、多くの興味深い動作をサポートすることができる。ご覧の通り、驚くほど簡単で、実世界のブラウザを理解するのに必要な核となる概念をすべて示している。ブラウザはコードになることで、不可解なものではなくなるのだ。

序盤の章では、自身のブラウザを自分で構築していくことを目的としている。いったんブラウザを立ち上げ、動作させれば、パフォーマンスを向上させたり、機能を追加したりする機会は無限にあり、それらのいくつかは、練習問題として提示している。これらの練習問題の多くは実際のブラウザで実装されている機能であり、これら練習問題に触れることを推奨する。機能の追加はブラウザ開発の醍醐味のひとつである！

そして、私のChromeでの経験に基づき、実際のブラウザのレンダリングエンジンのアーキテクチャを具体化するための詳細や高度な機能へと本書は進んでいく。この本を読み終えた後には、それほど苦労することなく、ChromiumやGecko、WebKitのソースコードを掘り下げ、そして理解することができるようになっているはずだ。

この本を通じて、あなたがブラウザの奥深さ、複雑さ、パワーを理解することを私は願っている。この本が、ブラウザの美しさ、具体的には巧みなアルゴリズムやデータ構造、コンピューティングの文化や歴史との共進化、私たちの世界における中心性などを伝えてくれることを願っている。そして何よりも、この本が、あなた自身が未来のブラウザを作っている人物だと、あなたに感じさせてくれることを願っている。
